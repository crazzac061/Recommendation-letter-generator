{% extends 'base2.html' %} {% block title %}Generate{% endblock title %} 
{% block teacher %}<a href="teacher"><img src="{{teacher_model.images.url}}" style="width:33px;height:33px; border-radius: 50%;" ></a>{% endblock teacher %} 
{% block body %}
<div class="container">
  <div class="title">{{student.name}} has given these informations:</div>
  <br />
  <img src="{{files.Photo.url}}" class="rounded mx-auto d-block"  
        height="100px"
        width="100px"
        border-radius="50%" 
        border-color = "black"         
        alt="Avatar">
  <span class="details">You've known this student for: {{student.years_taught}}</span> <br />
  <span class="details">You've taught: {{student.subjects}}</span> <br />

  <span class="details">GPA: {{academics.gpa}}</span> <br />
  <span class="details">Tentative Ranking: {{academics.tentative_ranking}}</span> <br />

  <span class="details">Supervised Project: {{project.supervised_project}}</span>
  <br />
  
  <span class="details">Other projects: {{project.final_project}}</span>
  <br />
  {% for university in universities %}
    <br />
    <span class="details">University: {{university.uni_name}}</span> <br />
    <span class="details">University Deadline: {{university.uni_deadline}}</span> <br />
    <span class="details">Program Applied: {{university.program_applied}}</span> <br />
  {% endfor %}
  <br />
  <span class="details">LinkedIn Profile: {{linkedin}}</span> <br />
<br>
  <span class="details">Extra curricular activities: {{quality.extracirricular}}</span> <br />
<br>
  <span class="details">Personal Statement: {{ personal_statement|linebreaksbr }}</span> <br />
<br>
  <span class="details">Recommendation Purpose: {{ recommendation_purpose|linebreaksbr }}</span> <br />
  <br />


  <!-- <h5>Universities Applied</h5>
  {% for university in universities %}
  <span class="details">University: {{university.uni_name}}</span> <br />
  <span class="details">University Deadline: {{university.uni_deadline}}</span> <br />
  <span class="details">Program Applied: {{university.program_applied}}</span> <br />
  <br />
  {% endfor %}
  <br /> -->

  <!-- Button trigger modal -->

{% if files.transcript.url|lower|slice:'-4:' == '.pdf' %}
  <!-- Display PDF in new tab -->
  <a href="{{ files.transcript.url }}" class="btn btn-primary" ata-bs-toggle="modal" data-bs-target="#exampleModal1" target="_blank">
    Show Transcript
  </a>
{% else %}

<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal1">
  Show transcript
</button>

<!-- Modal -->
<div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Transcript</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

          
            <!-- Display image -->
            <img src="{{ files.transcript.url }}" 
            height="100%"
            width="100%">
          

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

{% endif %}

<br />
<br/>

{% if files.CV.url|lower|slice:'-4:' == '.pdf' %}
  <!-- Display PDF in new tab -->
  <a href="{{ files.CV.url }}" class="btn btn-primary" ata-bs-toggle="modal" data-bs-target="#exampleModal1" target="_blank">
    Show CV
  </a>
{% else %}

<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal1">
  Show CV
</button>

<!-- Modal -->
<div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Transcript</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

          
            <!-- Display image -->
            <img src="{{ files.CV.url }}" 
            height="100%"
            width="100%">
          

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

{% endif %}

  <br />
  {% if student.paper == "Yes" %}
  <span class="details">Paper: <a target="_blank" href="{{paper.paper_link}}">{{paper.paper_title}}</a></span> <br />
  {% endif %}
  

  <!-- <div class="title">Give Information for {{student.name}}</div> -->
  <br />
  <div class="content">
    <form method="POST" id="recommendationForm" action="/renderCustom" >
      {% csrf_token %}
       <div class="user-details">
      <!--  <div class="input-box">
          <span class="details">Presentation skills:</span>
          <select name="presentation" required>
            <option></option>
            <option>good</option>
            <option>outstanding</option>
            <option>excellent</option>
          </select>
        </div>

        <div class="input-box">
          <span class="details">Extracirricular Activities</span>
          <select name="eca" required>
            <option></option>
            <option>Yes</option>
            <option>No</option>

          </select>
        </div>
        <div class="input-box">
          <span class="details">Academics Performance:</span>
          <select name="acad" required>
            <option></option>
            <option>topper</option>
            <option>top 10 %</option>
            <option>finest</option>
          </select>
        </div>
        <div class="input-box">
          <span class="details">Qualitiy:</span>
          <select name="qual" required>
            <option></option>
            <option>sincere and hardworking</option>
            <option>confident and responsible</option>
            <option>diligent and competitive</option>
          </select>
        </div>

        {% comment %}
        <div class="input-box">
          <span class="details">Project Details</span>
          <input type="text" name="quality3" />
        </div>
        {% endcomment %}

        <div class="gender-details">
          <span class="gender-title">Personal Qualities</span>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="quality1" id="flexCheckDefault" />
            <label class="form-check-label" for="flexCheckDefault">
              Leadership
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="quality2" id="flexCheckDefault" />
            <label class="form-check-label" for="flexCheckDefault">
              Hardworking
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="quality3" id="flexCheckDefault" />
            <label class="form-check-label" for="flexCheckDefault">
              Social
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="quality4" id="flexCheckDefault" />
            <label class="form-check-label" for="flexCheckDefault">
              Teamwork
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="quality5" id="flexCheckDefault" />
            <label class="form-check-label" for="flexCheckDefault">
              Friendly
            </label>
          </div>
          <div class="input-box">
            <input type="hidden" value="{{roll}}" name="roll" readonly />
          </div>
          <div class="button">
            <input type="submit" value="Submit" />
          </div>

        </div>-->
        <div class="input-box">
        <span class="details">Presentation skills:</span>
        <div style="display: flex; align-items: center; gap: 10px;">
          <select id="presentationSelect" required>
            <option></option>
            <option>good</option>
            <option>outstanding</option>
            <option>excellent</option>
          </select>
          <input type="text" id="presentationCustom" placeholder="Enter custom value" style="display: none;" />
          <input type="hidden" name="presentation" id="presentationFinal" /> <!-- final field -->
          <button type="button" onclick="toggleInput('presentation')" title="Enter custom value"
            style="background: none; border: none; cursor: pointer; padding: 0; display: flex; align-items: center;">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="black" xmlns="http://www.w3.org/2000/svg">
              <path d="M12.146 0.146a.5.5 0 01.708 0l3 3a.5.5 0 010 .708l-9.5 9.5a.5.5 0 01-.168.11l-5 2a.5.5 0 01-.65-.65l2-5a.5.5 0 01.11-.168l9.5-9.5zM11.207 3L13 4.793 14.293 3.5 12.5 1.707 11.207 3zm1.586 2L11 3.207 4 10.207V11h.793l7-7zM3.5 11.5l-.5 1.293L4.207 12l-1.293-.5z"/>
            </svg>
          </button>
        </div>
      </div>

      <div class="input-box">
        <span class="details">Quality:</span>
        <div style="display: flex; align-items: center; gap: 10px;">
          <select id="qualSelect" required>
            <option></option>
            <option>sincere and hardworking</option>
            <option>confident and responsible</option>
            <option>diligent and competitive</option>
          </select>
          <input type="text" id="qualCustom" placeholder="Enter custom value" style="display: none;" />
          <input type="hidden" name="qual" id="qualFinal" /> <!-- final field -->
          <button type="button" onclick="toggleInput('qual')" title="Enter custom value"
            style="background: none; border: none; cursor: pointer; padding: 0; display: flex; align-items: center;">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="black" xmlns="http://www.w3.org/2000/svg">
              <path d="M12.146 0.146a.5.5 0 01.708 0l3 3a.5.5 0 010 .708l-9.5 9.5a.5.5 0 01-.168.11l-5 2a.5.5 0 01-.65-.65l2-5a.5.5 0 01.11-.168l9.5-9.5zM11.207 3L13 4.793 14.293 3.5 12.5 1.707 11.207 3zm1.586 2L11 3.207 4 10.207V11h.793l7-7zM3.5 11.5l-.5 1.293L4.207 12l-1.293-.5z"/>
            </svg>
          </button>
        </div>
      </div>

      <div class="input-box">
        <span class="details">Recommend:</span>
        <div style="display: flex; align-items: center; gap: 10px;">
          <select id="recommendSelect" required>
            <option></option>
            <option>strongly</option>
            <option>firmly</option>
          </select>
          <input type="text" id="recommendCustom" placeholder="Enter custom value" style="display: none;" />
          <input type="hidden" name="recommend" id="recommendFinal" /> <!-- final field -->
          <button type="button" onclick="toggleInput('recommend')" title="Enter custom value"
            style="background: none; border: none; cursor: pointer; padding: 0; display: flex; align-items: center;">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="black" xmlns="http://www.w3.org/2000/svg">
              <path d="M12.146 0.146a.5.5 0 01.708 0l3 3a.5.5 0 010 .708l-9.5 9.5a.5.5 0 01-.168.11l-5 2a.5.5 0 01-.65-.65l2-5a.5.5 0 01.11-.168l9.5-9.5zM11.207 3L13 4.793 14.293 3.5 12.5 1.707 11.207 3zm1.586 2L11 3.207 4 10.207V11h.793l7-7zM3.5 11.5l-.5 1.293L4.207 12l-1.293-.5z"/>
            </svg>
          </button>
        </div>
      </div>


        <div class="gender-details">
          <span class="gender-title">Personal Qualities</span>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="quality1" id="flexCheckDefault" />
            <label class="form-check-label" for="flexCheckDefault">
              Leadership
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="quality2" id="flexCheckDefault" />
            <label class="form-check-label" for="flexCheckDefault">
              Hardworking
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="quality3" id="flexCheckDefault" />
            <label class="form-check-label" for="flexCheckDefault">
              Social
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="quality4" id="flexCheckDefault" />
            <label class="form-check-label" for="flexCheckDefault">
              Teamwork
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="quality5" id="flexCheckDefault" />
            <label class="form-check-label" for="flexCheckDefault">
              Friendly
            </label>
          </div>
        </div>

        <div class="input-box">
          <span class="details">Choose Template</span>
           <select name="temp" id="template" required>
            <option value = 'default'>Default</option>
             {% for template in templates %}
             <option value="{{template.template_name}}">{{template.template_name}}</option>
             {% endfor %}

             <!-- <option value = "default" >Default</option> Default Template -->
           </select>
         </div>
       
    </div> 
  
  <div class="input-box">
    <input type="hidden" value="{{roll}}" name="roll" readonly />
  </div>
<!-- 
  <div class="input-box">
    <input type="hidden" value="{{student.professor}}" name="name" readonly />
  </div> -->
  
  <div class="button">
    <input type="submit" value="Submit" />
  </div>
    </form>
  </div>
  </div>
</div>

<script>
    const form = document.getElementById('recommendationForm');
    const templateSelect = document.getElementById('template');

    function updateFormAction() {
      const selectedTemplate = templateSelect.value;
      if (selectedTemplate.toLowerCase() === 'default') {
        form.action = '/edit';
      } else {
        form.action = '/renderCustom';
      }
    }

    // Update action on page load
    updateFormAction();

    // Update action when dropdown changes
    templateSelect.addEventListener('change', updateFormAction);

    function toggleInput(field) {
    const select = document.getElementById(field + 'Select');
    const input = document.getElementById(field + 'Custom');

    const usingCustom = input.style.display === 'inline-block';

    if (usingCustom) {
      input.style.display = 'none';
      input.value = '';
      select.style.display = 'inline-block';
      select.required = true;
      input.required = false;
    } else {
      select.style.display = 'none';
      select.value = '';
      input.style.display = 'inline-block';
      input.required = true;
      select.required = false;
    }
  }

  function toggleInput(field) {
  const select = document.getElementById(field + 'Select');
  const input = document.getElementById(field + 'Custom');

  const usingCustom = input.style.display === 'inline-block';

  if (usingCustom) {
    input.style.display = 'none';
    input.value = '';
    select.style.display = 'inline-block';
    select.required = true;
    input.required = false;
  } else {
    select.style.display = 'none';
    select.value = '';
    input.style.display = 'inline-block';
    input.required = true;
    select.required = false;
  }
}

  form.addEventListener('submit', function () {
    document.getElementById('presentationFinal').value =
      document.getElementById('presentationSelect').style.display !== 'none'
        ? document.getElementById('presentationSelect').value
        : document.getElementById('presentationCustom').value;

    document.getElementById('qualFinal').value =
      document.getElementById('qualSelect').style.display !== 'none'
        ? document.getElementById('qualSelect').value
        : document.getElementById('qualCustom').value;

    document.getElementById('recommendFinal').value =
      document.getElementById('recommendSelect').style.display !== 'none'
        ? document.getElementById('recommendSelect').value
        : document.getElementById('recommendCustom').value;
  });

</script>


{% endblock body %}